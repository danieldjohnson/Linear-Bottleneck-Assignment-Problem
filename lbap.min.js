function lbap_pairs(e,t,n){var r=[];for(var i=e.length-1;i>=0;i--){var s=e[i];r[i]=[];for(var o=t.length-1;o>=0;o--){var u=t[o];r[i][o]=n(s,u)}}return lbap(r)}function lbap(e){function t(t){var n=[];var r=[];for(var i=0;i<s;i++){n[i]={idx:i,adj:[],numIdentical:0,match:false};r[i]={idx:i,adj:[],numIdentical:0,match:false}}for(var i=0;i<s;i++){for(var o=0;o<s;o++){if(e[i][o]<=t){var u=n[i];var a=r[o];if(e[i][o]==0){u.adj.push(u.adj[u.numIdentical]);a.adj.push(a.adj[a.numIdentical]);u.adj[u.numIdentical++]=a;a.adj[a.numIdentical++]=u}else{n[i].adj.push(r[o]);r[o].adj.push(n[i])}}}}while(true){var f=new Array(s);var l=new Array(s);var c=new Queue,h=new Queue;_.each(n,function(e,t){if(!e.match){c.enqueue(e);f[t]=1}});var p=2;var d=true;while(true){var v=[],m,g;while(!c.isEmpty()){m=c.dequeue();for(var i=m.adj.length-1;i>=0;i--){var y=m.adj[i];if(l[y.idx])continue;l[y.idx]=p;h.enqueue(y);if(!y.match){v.push(y)}}}if(v.length==0){p++;if(h.isEmpty()){d=false;break}while(!h.isEmpty()){g=h.dequeue();var b=g.match;f[b.idx]=p;c.enqueue(b)}p++}else{for(var i=0;i<v.length;i++){if(v[i].numIdentical==0)continue;w(v[i].idx)}for(var i=0;i<v.length;i++){if(v[i].numIdentical!=0)continue;w(v[i].idx)}break;function w(e){var t=r[e],n=l[e];for(var i=0;i<t.adj.length;i++){var s=t.adj[i];if(f[s.idx]==n-1){var o=E(s.idx);if(o){t.match=s;s.match=t;l[e]=-1;return true}}}return false}function E(e){var t=n[e],r=f[e];var i=t.match;if(!i){f[e]=-1;return true}else{var s=w(i.idx);if(s){f[e]=-1;return true}}return false}}}var S=new Array(s);for(var i=n.length-1;i>=0;i--){S[i]=n[i].match?n[i].match.idx:null}if(!d)break}var x=new Array(s);for(var i=n.length-1;i>=0;i--){x[i]=n[i].match.idx}return x}function r(e){var t=_.every(n(e),function(e){return e!=null});return t}var n=_.memoize(t);var i=_.flatten(e).sort(function(e,t){return e-t});var s=e.length;var o=i[0],u=i[i.length-1];var a=[];if(o==u){return _.range(s)}while(true){var f=_.indexOf(i,u,true),l=_.lastIndexOf(i,o,f)+1;if(l>=f)break;else{var c=l+Math.floor((f-l)/2),h=i[c];if(r(h)){u=h}else{o=h}a[h]=true}}if(!a[o]){if(r(o)){u=o}}var p=u;var d=n(p);return d}